###############################################################################
# Compiler Settings
###############################################################################
CC = gcc
CFLAGS = -Wall -Wextra -std=gnu89 -g

###############################################################################
# PF Layer Source Paths (ADJUST THIS IF NEEDED)
###############################################################################
PF_DIR = ../pflayer

PF_SRCS = $(PF_DIR)/pf.c \
          $(PF_DIR)/hash.c \
          $(PF_DIR)/buf.c \
          $(PF_DIR)/pageOperation.c

PF_OBJS = $(PF_SRCS:.c=.o)

###############################################################################
# HF Layer Sources
###############################################################################
HF_SRCS = hf.c
HF_OBJS = $(HF_SRCS:.c=.o)

###############################################################################
# Test File
###############################################################################
TEST = hf_test
TEST_SRC = testhf.c
TEST_OBJ = $(TEST_SRC:.c=.o)

###############################################################################
# Default target
###############################################################################
all: $(TEST)

###############################################################################
# Link the final executable
###############################################################################
$(TEST): $(HF_OBJS) $(PF_OBJS) $(TEST_OBJ)
	$(CC) $(CFLAGS) -o $(TEST) $(HF_OBJS) $(PF_OBJS) $(TEST_OBJ)

###############################################################################
# Compile rules
###############################################################################
%.o: %.c
	$(CC) $(CFLAGS) -I$(PF_DIR) -c $< -o $@

$(PF_DIR)/%.o: $(PF_DIR)/%.c
	$(CC) $(CFLAGS) -c $< -o $@

###############################################################################
# Clean
###############################################################################
clean:
	rm -f *.o
	rm -f $(PF_DIR)/*.o
	rm -f $(TEST)
